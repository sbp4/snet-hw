# Домашнее задание к занятию "4.2. L2-сеть"

---

### Задание 1. 

Адрес канального уровня – MAC адрес – это 6 байт, первые 3 из которых называются OUI – Organizationally Unique Identifier или уникальный идентификатор организации.

Какому производителю принадлежит `MAC 38:f9:d3:55:55:79`?

*Приведите ответ в свободной форме.*

***Ответ:***

Данный MAC-адрес принадлежит производителю Apple, Inc.

<a href="https://ibb.co/ncgJhBT"><img src="https://i.ibb.co/bBW9pFx/1-1.png" alt="1-1" border="0"></a>

---

### Задание 2. 

Какой ключ нужно добавить в `tcpdump`, чтобы он начал выводить не только заголовки, но и содержимое фреймов  в:

 - текстовом виде;
 - текстовом и шестнадцатиричном виде?

*Приведите ответ в свободной форме.*

***Ответ:***

1. sudo tcpdump -e -A (выводит заголовки и содержимое фреймов в ASCII формате)
2. sudo tcpdump -XX (выводит заголовки (включая канальный уровнь) и данные в шестнадцатеричном виде и в ASCII формате)
3. sudo tcpdump -X (выводит заголовки (кроме канального уровня) и данные в шестнадцатеричном виде и в ASCII формате)

---

### Задание 3. 

1. Можно ли изменить MAC-адрес вашего Linux сервера?
2. Если да, то какой командой, если нет - почему?
3. Для чего может понадобиться изменять MAC-адреса?
 
*Приведите ответ в свободной форме.*

***Ответ:***

1. Да, изменить MAC-адрес Linux сервера можно;
2. `sudo ifconfig enp0s3 down && sudo ifconfig enp0s3 hw ether 08:00:27:e3:f7:7f && sudo ifconfig enp0s3 up`, вернуть обратно реальный MAC-адрес можно той же комбинацией, но вместо фейкового использовать настоящий. Кроме этого, можно использовать утилиту macchanger - `sudo macchanger --mac=08:00:27:e3:f7:7f enp0s3`, вернуть обратно реальный MAC-адрес можно командой `sudo macchanger -p enp0s3`. Сгенерировать рандомный MAC-адрес - `sudo macchanger -r enp0s3`. Также можно использовать `sudo ip link set dev enp0s3 down && sudo ip link set dev enp0s3 address 08:00:27:e3:f7:7f && sudo ip link set dev enp0s3 up `, вернуть обратно реальный MAC-адрес можно той же комбинацией, но вместо фейкового использовать настоящий.
3. К примеру, если у нас вышла из строя сетевая карта на "гейте" (которым может быть Linux сервер), а провайдер использует жесткую привязку по MAC-адресу.

---

### Задание 4. 

1. Как можно прописать соответствие `IP-MAC` вручную?
2. Какие плюсы и какие минусы у данного решения?

*Приведите ответ в свободной форме.*

***Ответ:***

1. Сделать это можно двумя способами: 
   - `ip neigh add 10.10.2.5 lladdr 08:00:27:e3:f7:7f dev enp0s3`
   - `arp -s 10.10.2.5 08:00:27:e3:f7:7f`
2. Плюсы - у устройства всегда будет постоянный IP-адрес, привязанный к MAC-адресу. Минусы - все это необходимо прописывать вручную на каждом устройстве. Дополнительные затраты по времени. 

---

### Задание 5. 

Какой механизм проверки на наличие ошибок используется в `Ethernet`?

*Приведите ответ в свободной форме.*

***Ответ:***

Для проверки на наличие ошибок используется контрольная сумма (CRC) кадра. Значение суммы добавляется в конец кадра. При получении вычисляется CRC кадра и сравнивается с отправленной. Если они совпадают, кадр принимается, если различаются - удаляется.

---

### Задание 6. 

Как вы думаете, почему серверы в большинстве случаев подключают проводом, а не через `WiFi`?

*Приведите как можно больше доводов в свободной форме.*

***Ответ:***

В большинстве случаев серверы подключают проводом, так как проводное соединение предоставляет более высокую скорость передачи данных, эта скорость постоянна и не меняется под воздействием различного рода помех (если правильно спроектирована сеть и рядом нет электрической проводки), кроме этого при использовании проводного соединения не возникает коллизий.

---

### Задание 7. 

Сколько доменов коллизий изображено на рисунке?

_Примечение:_

 - нижнее устройство - хаб, работающий на 1-м уровне, которые переадресовывает всё, что приходит во все порты сразу, ничего не анализируя; 
 - в центре - коммутатор, работает на 2-м уровне.
 - круглое устройство - маршрутизатор, работает на 3-м уровне модели OSI.

![](https://i.imgur.com/ZSKmvMy.png)

***Ответ:***

**UPD** На данном рисунке изображено <del>3 домена коллизий</del> <del>5 доменов коллизий</del> 4 домена коллизий. 

<a href="https://ru.bmstu.wiki/%D0%94%D0%BE%D0%BC%D0%B5%D0%BD_%D0%BA%D0%BE%D0%BB%D0%BB%D0%B8%D0%B7%D0%B8%D0%B9">**Домен коллиизий**</a> — это часть сети Ethernet, все узлы которой конкурируют за общую разделяемую среду передачи и, следовательно, каждый узел которой может создать коллизию с любым другим узлом этой части сети. Исходя из этого определения, можно сделать вывод, что каждое подключенное к коммутатору устройство создает домен коллизий (Домен коллизий №1, №2).  Однако, если несколько устройств подключены к коммутатору через хаб, они создают один домен коллизий (Домен коллизий №3). Кроме этого, домен коллизий создает и подключенный к коммутатору маршрутизатор (Домен коллизий №4). <del>И, насколько я понял, коммутатор в том числе создает домен коллизий с маршрутизатором (Домен коллизий №5), так как для сегментации физической сети применяются мосты, коммутаторы и другие сетевые устройства более высокого уровня (маршрутизаторы).</del>

<del><a href="https://ibb.co/9GtCmRW"><img src="https://i.ibb.co/0QtdpPr/7-1.png" alt="7-1" border="0"></a></del>

Правильный ответ:

<a href="https://ibb.co/mzLYyCJ"><img src="https://i.ibb.co/q1t4gMB/7-2.png" alt="7-2" border="0"></a>

---

### Задание 8. 

Сколько широковещательных доменов изображено на рисунке?

_Примечение:_ круглое устройство - маршрутизатор, работает на 3-м уровне модели OSI. 

![](https://i.imgur.com/D9uUHGW.png)

***Ответ:***

На данном рисунке изображено 3 широковещательных домена.

---


**

## Дополнительные задания (со звездочкой*)
Эти задания дополнительные (не обязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.

### Задание 9. 

1. Собрите дамп трафика с помощью `tcpdump` на основном интерфейсе вашей виртуальной машины.
2. Посмотрите его через `tshark` или `Wireshark` *(можно ограничить число пакетов -c 100).* 
3. Как на самом деле называется стандарт `Ethernet`, фреймы которого попали в ваш дамп? 
4. Можно ли где-то в дампе увидеть `OUI`?

*Приведите ответ в свободной форме.*

***Ответ:***

1. Стандарт `Ethernet` называется `EN10MB` в выводе записывается как `link-type EN10MB (Ethernet)`

<a href="https://ibb.co/BNDryFm"><img src="https://i.ibb.co/jRKWysd/9-1.png" alt="9-1" border="0"></a>

2. `OUI` можно увидеть внутри перехваченного кадра в утилите wireshark рис.9.2., а также вывести с помощью команды `tshark -r tcpdump.pcap -T fields -e eth.addr_resolved` рис.9.3. Вывод `wireshark` читать удобнее. 

Рис.9.2

<a href="https://ibb.co/9hZVNs0"><img src="https://i.ibb.co/68X1mgS/9-2.png" alt="9-2" border="0"></a>

Рис.9.3

<a href="https://ibb.co/BwyR7fP"><img src="https://i.ibb.co/hCBvngM/9-3.png" alt="9-3" border="0"></a>
