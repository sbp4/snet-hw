# Домашнее задание к занятию "4.3. L3-сеть"

---

### Задание 1. 

1. Сколько доступно для назначения хостам адресов в подсети `/25`?
2. А в подсети с маской `255.248.0.0`. 

_Примечение:_ постарайтесь потренироваться в ручных вычислениях чтобы немного набить руку, не пользоваться калькулятором сразу.

*Приведите ответ в свободной форме.*

***Ответ:***

1. В подсети `/25` доступно 126 адресов. Расчет производится следующим образом: 32 - 25 = 7 (бит хостовой части). 2^7 = 128 адресов - 2 адреса (адрес подсети и широковещательный адрес) = 126 адресов.

2. В подсети с маской `255.248.0.0` или в подсети `/13` доступно 524 286 адресов. Расчет производится следующим образом: два последних октета маски = 16 хостовых бит, во втором октете маски 5 бит сетевых, 3 хостовых бита. 16 + 3 = 19 (бит хостовой части). 2^19 = 524 288 адресов - 2 адреса (адрес подсети и широковещательный адрес) = 524 286 адресов.

---

### Задание 2. 

В какой подсети больше адресов, в `/23` или `/24`?

*Приведите ответ в свободной форме.*

***Ответ:***

В `/23` подсети на 256 адресов больше, чем в `/24`.
Количество адресов в `/23` подсети: 32 - 23 = 9 (бит хостовой части). 2^9 = 512 адресов
Количество адресов в `/24` подсети: 32 - 24 = 8 (бит хостовой части). 2^8 = 256 адресов

---

### Задание 3. 

1. Получится ли разделить диапазон `10.0.0.0/8` на 128 подсетей по 131070 адресов в каждой?
2. Какая маска будет у таких подсетей?

*Приведите ответ в свободной форме.*

***Ответ:***

1. Диапазон `10.0.0.0/8` получится разделить на 128 подсетей по 131 070 адресов в каждой. Рассчитать это можно следующим образом: 32 - 8 = 24 (бита хостовой части). 2^24 = 16 777 216 адресов. Далее 16 777 216 адресов / 128 подсетей = 131 072 - 2 адреса (адрес подсети и широковещательный адрес) = 131 070 адресов в каждой сети.
2. У таких сетей маска подсети будет 255.0.0.0

---

### Задание 4. 

С помощью [дополнительных материалов](https://asp24.ru/novichkam/osnovy-kompyuternyh-setey.-tema-5.-ponyatie-ip-adresacii-masok-podsetey-i-ih-raschet/) укажите минимальную маску для подсети, в которой находится:

1. 12 хостов.
2. 39 хостов.
3. 2 хоста.
4. 4 хоста.

_Примечение:_ потренируйтесь указывать маску как в формате `255.255.255.0`, так и в формате `/24`.

*Приведите ответ в свободной форме.*

***Ответ:***

1. Для 12 хостов маска подсети будет 255.255.255.240 или /28
2. Для 39 хостов маска подсети будет 255.255.255.192 или /26
3. Для 2 хостов маска подсети будет 255.255.255.252 или /30
4. Для 4 хостов маска подсети будет 255.255.255.248 или /29


---

### Задание 5. 

Используя свои знания про L2 и L3, поразмышляйте:

 - получится ли отправить пакет с компьютера `192.168.1.2` на компьютер `192.168.1.3` если они подключены согласно приведённой ниже схеме?

![](https://i.imgur.com/fOE0vdh.png)

*Дайте максимально развернутый ответ.*

***Ответ:***

**UPD:** Шлюз по умолчанию (англ. Default gateway) — в маршрутизируемых протоколах — сетевой шлюз, на который пакет отправляется в том случае, если маршрут к сети назначения пакета не известен (не задан явным образом в таблице маршрутизации хоста). Таким образом, я продолжу настивать на ответе (хоть могу и ошибаться :), что отправить пакет с компьютера `192.168.1.2` на компьютер `192.168.1.3` не получится (в рассматриваемой схеме). Маршрут к сети назначения пакета, в данном случае, известен. Он прописан в таблице маршрутизации хоста `192.168.1.2`. Используя таблицу маршрутизации и маску подсети, хост `192.168.1.2` определит, что компьютер `192.168.1.3` находится в той же подсети. Для того, чтобы определить MAC-адрес компьютера `192.168.1.3` хост `192.168.1.2` отправит ARP-запрос, ответ на который не будет получен. В результате, хост `192.168.1.2` выдаст ошибку отправки пакета на адрес `192.168.1.3`. 

**OLD:** 
Если компьютеры подключены согласно приведенной выше схеме, то отправить пакет с компьютера `192.168.1.2` на компьютер `192.168.1.3` не получится. Вот по какой причине. Компьютер с адресом `192.168.1.2` определит по маске подсети /24, что компьютер с адресом `192.168.1.3` находится в его подсети. Далее `192.168.1.2` сформирует ARP-запрос для того, чтобы определить MAC-адрес `192.168.1.3` для последующей передачи данных. Но ответа не получит, так как `192.168.1.3` находится за двумя маршрутизаторами. Не получив ответ на ARP-запрос, `192.168.1.# 2` ничего никуда не отправит. В маршрут по умолчанию, `192.168.1.2` смотреть не будет, так как по исходным данным `192.168.1.3` находится в его подсети.

---

### Задание 6. 

Используя свои знания про маску подсети, L2 и L3, ответьте на вопросы:

- смогут ли общаться между собой компьютеры `192.168.1.25/24` и `192.168.1.2/30`?
- сможет ли выйти в интернет компьютер `192.168.1.25/24`, если шлюзом прописан маршрутизатор `192.168.1.1`?
- сможет ли выйти в интернет компьютер `192.168.1.2/30`, если шлюзом прописан маршрутизатор `192.168.1.1`?

![](https://i.imgur.com/fVos5Ec.png)

*Дайте максимально развернутый ответ.*

***Ответ:***

1. Компьютеры `192.168.1.25/24` и `192.168.1.2/30` общаться между собой не смогут, так как `192.168.1.25`, посмотрев на маску подсети, определит, что `192.168.1.2` находится в его подсети. Далее, `192.168.1.25` сформирует и отправит ARP-запрос. `192.168.1.2`, получив ARP-запрос, посмотрит в свою маску подсети и поймет, что `192.168.1.25` не в его подсети. Далее `192.168.1.2` отправит ответ на ARP-запрос на маршрутизатор, используя маршрут по умолчанию. Но маршрутизатор этот ответ отбросит, так как у него прописана другая маска подсети.

2. Компьютер `192.168.1.25/24` сможет выйти в интернет , если шлюзом прописан маршрутизатор `192.168.1.1`. К примеру, `192.168.1.25` обращается к `yandex.ru`. С помощью DNS резолвит его айпишник и получает в ответ 5.255.255.77. Далее, `192.168.1.25` смотрит в маску подсети и понимает, что айпишник Яндекса находится вне его сети. Определив, что для обращения к Яндексу необходимо использовать маршрут по умолчанию, `192.168.1.25` сформирует и отрпавит ARP-запрос для определения MAC-адреса шлюза. Шлюз, получив ARP-запрос от `192.168.1.25`, посмотрим в маску и поймет, что они в одной сети. После чего отправит ответ `192.168.1.25` со своим MAC-адресом. Далее, `192.168.1.25` начнет обмен фреймами с `192.168.1.1`.

**UPD:** 
3. Компьютер `192.168.1.2/30` **сможет** выйти в интернет , если шлюзом прописан маршрутизатор `192.168.1.1/24`, так как маска /30 включает в сеть `192.168.1.0` два ip-адреса: `192.168.1.1` и `192.168.1.2`. К примеру, `192.168.1.2` обращается к `google.com`. С помощью DNS резолвит его айпишник и получает в ответ `74.125.205.138`. Далее, `192.168.1.2` смотрит в локальную таблицу маршрутизации и понимает, что айпишник Google находится вне его сети. Определив, что для обращения к Google необходимо использовать маршрут по умолчанию, `192.168.1.2` сформирует и отправит ARP-запрос для определения MAC-адреса шлюза. Шлюз, получив ARP-запрос от `192.168.1.2`, посмотрит в свою локальную таблицу маршрутизации и определит, что хост `192.168.1.2` находится в той же сети и отправит ARP-ответ. Далее, хост `192.168.1.2` начнет обмен фреймами с `192.168.1.1`.

---

### Задание 7. 

Мы купили новый роутер, в инструкции написано, что у него статический адрес `10.0.0.1/24`.

На нашем компьютере прописан адрес `192.168.1.25/24`, шлюз по-умолчанию `192.168.1.1`.

- откроется ли окно для настройки роутера если ввести адрес 10.0.0.1 в браузер?
- почему?
- что рекомендуется делать в таком случае?

![](https://i.imgur.com/gjYxT7g.png)

*Приведите ответ в свободной форме.*

***Ответ:***

1. Окно для настройки роутера не откроется;

2. Компьютер и роутер находятся в разных сетях и не видят друг друга;

3. Для того, чтобы открыть окно настройки роутера, на сетевом интерфейсе компьютера следует прописать адрес той сети, в которой находится роутер, к примеру `10.0.0.2/24`. Произнести магическое заклинание: "Сим салабим". После чего, открыть окно настройки роутера и произвести магические действия по его настройке.

---

### Задание 8. 

Выберите корректные IP-адреса


| № | IP |
| -------- | -------- |
| 1. | 192.168.1.1 |
| 2. | 273.566.48.1 |
| 3. | 90.90.10.1 |
| 4. | 192.168.3 |
| 5. | 0.165.14.5 |
| 6. | 1.1.1.1 |


*В ответе приведите номера корректных пунктов. При желании напишите, что не так у остальных.*

***Ответ:***

1. 192.168.1.1 - корректный;
2. 273.566.48.1 - некорректный, первый и второй октет 12-битные, а должны быть 8-битными;
3. 90.90.10.1 - корректный;
4. 192.168.3 - некорректный, указаны только сетевые октеты, не хватает еще одного октета - хостового, состоящего из 8 бит;
5. 0.165.14.5 - некорректный, первый октет не может быть равен 0, он должен начинаться с единицы;
6. 1.1.1.1 - корректный.

---


**

## Дополнительные задания (со звездочкой*)
Эти задания дополнительные (не обязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.

### Задание 9. 

Попробуйте собрать дамп трафика с помощью `tcpdump` на основном интерфейсе вашей виртуальной машины и посмотреть его через `tshark` или `Wireshark`.

_Примечение:_ можно ограничить число пакетов -c 100.

Встретились ли вам какие-то установленные флаги на уровне Internet Protocol (не флаги TCP, а именно флаги IP)? 

*Приведите ответ в свободной форме.*

***Ответ:***

При анализе собранного `tcpdump` трафика с помощью утилиты `Wireshark` удалось найти следующие установленные флаги на уровне Internet Protocol:
1. IP version 4;
2. DCSP: CS0, ECN: Not-ECT;
3. Total Length: 40
4. Flags: 0x4000, Don't fragment
5. TTL: 64
6. Source: 10.0.2.15 (10.0.2.15)
7. Destination: detectportal.firefox.com (34.107.221.82)

Данные флаги хорошо читаемы на скрине ниже:

<a href="https://ibb.co/gwJMdk7"><img src="https://i.ibb.co/rMHG3Dt/9-1.png" alt="9-1" border="0"></a>